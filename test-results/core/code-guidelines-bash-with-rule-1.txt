=== Test Configuration ===
Rule: .firebender/mdc/core/code-guidelines.mdc
File: test-files/bash/sample-script.sh
Query: Review this code and suggest improvements
Mode: with_rule
Date: seg 19 mai 2025 16:57:46 -03

=== File Content ===
#!/bin/bash
set -euo pipefail
trap 'echo "Error at line $LINENO"; exit 1' ERR

# Sample bash script with common issues for testing MDC rules

# No error handling
cd /some/directory || { echo "Directory change failed"; exit 1; }

# Using unsafe variable expansion
echo "Processing file: ${file:-undefined}"

# Not quoting variables
mapfile -t files < <(ls -1 *.txt 2>/dev/null || echo "")
for file in "${files[@]}"; do
    echo "Processing ${file}"
done

# Command without checking exit code
if ! rm -rf /tmp/test-dir; then
    echo "Failed to remove directory"
fi

# Hardcoded paths
LOG_FILE="${LOG_FILE:-/var/log/app.log}"
log_file="$LOG_FILE"

# Function without local variables
process_data() {
    local result="Processed data"
    echo "$result"
}

# No input validation
if [[ -z "${1:-}" ]]; then
    echo "Error: Missing required argument"
    exit 1
fi
user_input="$1"
echo "User provided: $user_input"

# Using deprecated syntax
cleanup() {
    echo "Cleaning up..."
}

# Piping to commands without error checking
if ! grep "pattern" file.txt; then
    echo "Pattern not found"
fi
=== Test Query ===
Review this code and suggest improvements

=== Response ===
Script issues:

1. Add directory change error handling: